# Бот для управления мероприятиями

Бот для Telegram, который помогает управлять мероприятиями в нескольких группах с системой администрирования.

## Возможности

- **Многогрупповая поддержка**: Бот может работать в нескольких группах одновременно
- **Автоматическая регистрация групп**: При добавлении бота в группу она автоматически регистрируется в системе
- **Система администрирования**: Создатель группы и назначенные админы могут управлять мероприятиями
- **Планирование мероприятий**: Создание, редактирование и удаление мероприятий
- **Система бронирования**: Пользователи могут бронировать мероприятия
- **Автоматические напоминания**: Уведомления за 3 дня, 2 дня и 2 часа до мероприятия

## Установка и настройка

### 1. Клонирование и установка зависимостей

```bash
git clone <repository-url>
cd zvuk2
pip install -r requirements.txt
```

### 2. Настройка конфигурации

Создайте файл `.env` в корневой директории:

```env
# Настройки бота
BOT_TOKEN=ваш_токен_бота
SUPERADMIN_ID=ваш_id_в_telegram
```

### 3. Миграция базы данных

```bash
python migrate_db.py
```

### 4. Запуск бота

```bash
python bot.py
```

## Структура базы данных

### Таблица `groups`
- `id` - уникальный идентификатор группы
- `chat_id` - ID чата в Telegram
- `title` - название группы
- `created_by` - ID пользователя, создавшего группу

### Таблица `group_admins`
- `id` - уникальный идентификатор записи
- `group_id` - ID группы
- `admin_id` - ID админа группы

### Таблица `events`
- `id` - уникальный идентификатор мероприятия
- `name` - название мероприятия
- `time` - дата и время мероприятия
- `responsible` - ответственный за мероприятие
- `group_id` - ID группы, к которой относится мероприятие

## Команды бота

### Основные команды
- `/start` - начало работы с ботом
- `/help` - справка по командам

### Управление группами
- `/my_groups` - показать группы где вы админ
- `/add_admin ГРУППА_ID ПОЛЬЗОВАТЕЛЬ_ID` - добавить админа в группу
- `/remove_admin ГРУППА_ID ПОЛЬЗОВАТЕЛЬ_ID` - удалить админа из группы

### Управление мероприятиями
- `/add_event ДД.ММ.ГГГГ ЧЧ:ММ Название ГРУППА_ID` - добавить мероприятие
- `/remove_event ID` - удалить мероприятие
- `/list_events` - список всех мероприятий
- `/remind_events` - показать предстоящие мероприятия (в группе)
- `/update` - обновить все напоминания

## Система прав

### Суперадмин
- Доступ ко всем группам и мероприятиям
- Может добавлять/удалять админов в любых группах
- Полный контроль над системой

### Создатель группы
- Полный контроль над своей группой
- Может добавлять/удалять админов
- Управление мероприятиями в группе

### Админ группы
- Управление мероприятиями в группе
- Просмотр информации о группе
- Не может управлять другими админами

## Автоматические функции

### Регистрация групп
При добавлении бота в группу:
1. Группа автоматически регистрируется в системе
2. Пользователь, добавивший бота, становится создателем группы
3. Бот отправляет сообщение с ID группы

### Напоминания
Автоматические уведомления отправляются:
- За 3 дня до мероприятия
- За 2 дня до мероприятия  
- За 2 часа до мероприятия

## Примеры использования

### Добавление мероприятия
```
/add_event 25.12.2024 15:00 Встреча команды 1
```

### Добавление админа
```
/add_admin 1 123456789
```

### Просмотр мероприятий группы
- В группе: `/remind_events` - мероприятия текущей группы
- В группе: `/remind_events 2` - мероприятия группы с ID 2
- В личке: `/remind_events 1` - мероприятия группы с ID 1

## Безопасность

- Все команды проверяют права доступа
- Пользователи могут управлять только своими группами
- Суперадмин имеет полный доступ ко всему
- Создатель группы не может быть удален из админов

## Поддержка

При возникновении проблем:
1. Проверьте правильность настройки `.env`
2. Убедитесь, что база данных мигрирована
3. Проверьте логи бота
4. Убедитесь, что у бота есть права администратора в группах
